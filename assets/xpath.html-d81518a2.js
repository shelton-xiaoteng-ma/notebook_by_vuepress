import{_ as s,Y as n,Z as a,a4 as t}from"./framework-957baa9a.js";const e={},l=t(`<h1 id="xpath" tabindex="-1"><a class="header-anchor" href="#xpath" aria-hidden="true">#</a> XPATH</h1><p>[TOC]</p><p>XPathå³ä¸ºXMLè·¯å¾„è¯­è¨€ï¼ˆXML Path Languageï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨æ¥ç¡®å®šXMLæ–‡æ¡£ä¸­æŸéƒ¨åˆ†ä½ç½®çš„è¯­è¨€ã€‚ XPathåŸºäºXMLçš„æ ‘çŠ¶ç»“æ„ï¼Œæä¾›åœ¨æ•°æ®ç»“æ„æ ‘ä¸­æ‰¾å¯»èŠ‚ç‚¹çš„èƒ½åŠ›ã€‚</p><h2 id="_1-ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#_1-ç”¨æ³•" aria-hidden="true">#</a> 1. ç”¨æ³•</h2><ol><li><p>åŸºæœ¬ç”¨æ³•</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
html <span class="token operator">=</span> response<span class="token punctuation">.</span>text  <span class="token comment"># requestså’Œscrapyéƒ½å¯ä»¥, htmlè¦æ±‚æ˜¯str</span>
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
tr <span class="token operator">=</span> page_source<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//div[@class=&quot;chunk&quot;]/table/tr[1]&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>page_source HTMLæ–¹æ³•æœ‰è‡ªåŠ¨ä¿®æ­£ä¸å…¨tagçš„åŠŸèƒ½, tostring()æ–¹æ³•è½¬æˆæºæ–‡ä»¶, ä¸ºbytesç±»å‹, éœ€è¦decodeä¸ºstr</p></li><li><p>ä¹Ÿå¯ä»¥ç›´æ¥è¯»å–æ–‡æœ¬æ–‡ä»¶è¿›è¡Œè§£æ</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;./test.html&#39;</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>HTMLParser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token comment"># å¯ä»¥è½¬æ¢ç¼–ç é—®é¢˜</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> pretty_print <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">&quot;html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¯¹äºxmlçš„å“åº”</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>XML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>  <span class="token comment"># requests</span>
page_source <span class="token operator">=</span> etree<span class="token punctuation">.</span>XML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># scrapy</span>
<span class="token comment"># å¦‚æœä½¿ç”¨text, &#39;å¯èƒ½æŠ¥é”™: Unicode strings with encoding declaration are not supported. Please use bytes input or XML fragments without declaration&#39;.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="_2-å¸¸ç”¨è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_2-å¸¸ç”¨è§„åˆ™" aria-hidden="true">#</a> 2. å¸¸ç”¨è§„åˆ™</h2><ul><li><p>/ # ä»å½“å‰èŠ‚ç‚¹é€‰å–æ‰€æœ‰å­èŠ‚ç‚¹, è¿”å›list</p></li><li><p>// # ä»å½“å‰èŠ‚ç‚¹é€‰å–æ‰€æœ‰å­å­™èŠ‚ç‚¹, è¿”å›list</p></li><li><p>. # é€‰å–å½“å‰èŠ‚ç‚¹</p></li><li><p>.. # é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</p></li><li><p>@ # é€‰å–å±æ€§</p></li><li><p>[@] # å¢åŠ å±æ€§é™å®š å¦‚://div[@class=&quot;xx-name&quot;], çˆ¶èŠ‚ç‚¹ä¸‹æ‰€æœ‰classæ˜¯xx-nameçš„div</p></li><li><p>/text() # æ–‡æœ¬è·å–, è¿”å›list</p></li><li><p>å±æ€§å¤šå€¼åŒ¹é… # æŸä¸ªèŠ‚ç‚¹çš„å±æ€§æœ‰å¤šä¸ªå€¼, æ¯”å¦‚<code>&lt;a class=&#39;li tag&#39;&gt;</code>,</p><ul><li>//li[contains(@class, &quot;li&quot;)] # é€‰æ‹©æ‰€æœ‰åŒ…å«liçš„æ ‡ç­¾</li><li>//li[contains(@class, &quot;li&quot;) and contains(@class, &quot;tag&quot;)] # èƒ½é€‰æ‹©ä¸Šé¢é‚£ä¸ªæ ‡ç­¾</li><li>//li[contains(@class, &quot;li&quot;) and @name=&quot;item&quot;] # å¯ä»¥åŒæ—¶é€‰æ‹©å¤šä¸ªå±æ€§æ¡ä»¶</li></ul></li><li><p>| æˆ–æ“ä½œ</p><ul><li>//li[contains(@class, &quot;li&quot;)] | //li[@name=&quot;item&quot;] # ç”¨æ³•å’Œandç±»ä¼¼</li></ul></li><li><p>æŒ‰åºé€‰æ‹© # xpathçš„listé€‰æ‹©æ˜¯ä»1å¼€å§‹, last()è¡¨ç¤ºæœ€åä¸€ä¸ª</p></li><li><p>èŠ‚ç‚¹è½´</p><ul><li>html = etree.HTML(text)</li><li>result = html.xpath(&#39;//li[1]/ancestor:ğŸ˜—&#39;) # è¿”å›liçš„æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹, list</li><li>result = html.xpath(&#39;//li[1]/ancestor::div&#39;) # è¿”å›liçš„æ‰€æœ‰divç¥–å…ˆèŠ‚ç‚¹, list</li><li>result = html.xpath(&#39;//li[1]/attribute:ğŸ˜—&#39;) # è¿”å›liçš„æ‰€æœ‰å±æ€§å€¼, list</li><li>result = html.xpath(&#39;//li[1]/child::a[@href=&quot;https://ask.hellobi.com/link1.html&quot;]&#39;) # è¿”å›liçš„å­èŠ‚ç‚¹a</li><li>result = html.xpath(&#39;//li[1]/descendant::span&#39;) # è¿”å›liçš„æ‰€æœ‰spanå­å­™èŠ‚ç‚¹, list</li><li>result = html.xpath(&#39;//li[1]/following:ğŸ˜—[2]&#39;) # è¿”å›liçš„åç»­çš„ç¬¬2ä¸ªèŠ‚ç‚¹</li><li>result = html.xpath(&#39;//li[1]/following-sibling:ğŸ˜—&#39;) # è¿”å›liçš„åç»­æ‰€æœ‰åŒçº§èŠ‚ç‚¹, list</li><li>result = html.xpath(&#39;//li[1]/preceding-sibling::h6[1]&#39;) # è¿”å›liçš„å‰é¢çš„åŒçº§èŠ‚ç‚¹, list, [1]æŒ‡æœ€æ¥è¿‘li[1]çš„, ä¾æ¬¡å¾€å‰</li></ul></li></ul>`,7),p=[l];function i(o,c){return n(),a("div",null,p)}const r=s(e,[["render",i],["__file","xpath.html.vue"]]);export{r as default};
